<contract archiveOpt="P1Y" archiveReq="P1Y" canActAsTemplate="true" duration="P1Y" id="TransfereDaler" visibility="Public" xmlns="urn:ieee:iot:leg:sc:1.0">
	<Create xmlns="https://paiwise.tagroot.io/Schema/NeuroFeatures.xsd">
		<TokenID shortIdAlphabet="0123456789" shortIdLength="10">
			<Random />
		</TokenID>
		<Creator>
			<RoleReference role="Creator" />
		</Creator>
		<Owner>
			<RoleReference role="Creator" />
		</Owner>
		<TrustProvider>
			<RoleReference role="TrustProvider" />
		</TrustProvider>
		<Value>
			<ParameterReference parameter="Value" />
		</Value>
		<Currency>
			<ParameterReference parameter="Currency" />
		</Currency>
		<CommissionPercent>
			<ParameterReference parameter="CommissionPercent" />
		</CommissionPercent>
		<Expires>
			<ParameterReference parameter="Expires" />
		</Expires>

		<CreatorCanDestroy>
			<Boolean>true</Boolean>
		</CreatorCanDestroy>
		<OwnerCanDestroyIndividual>
			<Boolean>true</Boolean>
		</OwnerCanDestroyIndividual>
		<Definition>
			<StateMachine startState="TransfereDaler" xmlns="https://paiwise.tagroot.io/Schema/StateMachines.xsd">				
				<Variable id="Currency">
					<TagReference tag="Currency" />
				</Variable>
				<Variable id="TokenContract">
					<TokenProperty>CreationContract</TokenProperty>
				</Variable>
				<Variable id="Seller">
					<TagReference tag="Seller" />
				</Variable>	
				<Variable id="SendEdalerTo">
					<TagReference tag="SendEdalerTo" />
				</Variable>
				<Variable id="SendEdalerFrom">
					<TagReference tag="SendEdalerTo" />
				</Variable>
				<State id="TransfereDaler">
					<OnEnter actionRef="TransferEdalerAction" />				
				</State>				
				<Action id="TransferEdalerAction">
					<Try>				
					<Payment amount="1"
								contract="{TokenContract}"
			  				    currency="{Currency}"
												 from="{Seller}"
												 reference="{TokenContract}"
												 to="{SendEdalerTo}"
												 validDays="3" />	
					<TextNote content="{Seller}"/>	
					<Catch  exceptionVariable="ex">
					<TextNote content="{ex.Message}"/>			
					<Error reason="{ex.Message}"/>			
					</Catch>
					</Try>
				</Action>

				<Action id="End">
					<End />
				</Action>
				<ReportPresent>
| Variable            | Value                   |
|---------------------|-------------------------|
| AmountToPay         | {{AmountToPay}}         |
| Currency            | {{Currency}}            |
| TokenContract     | {{TokenContract}}     |
| Buyer               | {{Buyer}}          	 |
| Seller              | {{Seller}}          	|
	</ReportPresent>
			</StateMachine>
		</Definition>
		<Tag name="Seller">
			<RoleReference role="Creator" />
		</Tag>
		<Tag name="Title">
			<ParameterReference parameter="Title" />
		</Tag>
		<Tag name="Description">
			<ParameterReference parameter="Description" />
		</Tag>
		<Tag name="Value">
			<ParameterReference parameter="Value" />
		</Tag>
		<Tag name="Currency">
			<ParameterReference parameter="Currency" />
		</Tag>
		<Tag name="SendEdalerTo">
			<ParameterReference parameter="SendEdalerTo" />
		</Tag>		
		<Tag name="SendEdalerFrom">
			<ParameterReference parameter="SendEdalerFrom" />
		</Tag>		
		<FriendlyName>
			<ParameterReference parameter="Title" />
		</FriendlyName>
		<Category>
			<String>Vaulter</String>
		</Category>
		<Description>
			<ParameterReference parameter="Description" />
		</Description>
		<Glyph contentType="image/png">iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABFFJREFUeJztWU1IMlsYfrqTFmgLIb5yEURlLQo3YVZUCi1qFUFQUKt2QURWm7IgIkhqJ9IP1EIIWkWuIugPLIh0GVFUBC5SocCkEM2/uYvv3oPDNNM43Thwv3lgYM77d57zeI7nzEwBy7Is/mD8RZsAbSgC0CZAG4oAtAnQhiIAbQK0oQhAmwBtKALQJkAbigC0CdCGIgBtArShCECbAG0oAtAmQBuKALQJ0EahkCMYDGJpaQklJSV5F43H4+jr60NHRwfPNz8/j3g8jmw2i5qaGoyMjORdHwBSqRScTicODg5wfX2N19dXqNVqVFRUoLGxET09Pejv7/+6ECsAn8/HApB9LS4u8mo+PT3x4vJFJpNh29vbJfPY2dkRrSe4BL77uSCTyfBs4+PjPNvCwoLkmqenp2AYBufn55JzHh8fRf0FQh9G3t7ecHx8jOLiYo69tLQUZrOZtLe3t/Hr1y+k02liSyaTMBqNqKqq4nZWUAAA0Gg0iMVixC5FbK/XC6vVyrE1Nzdjbm4O3d3dYBiG2O/v77G7u4vZ2VlMT0/D4XAIF857Dv5mS65oNCopx+FwkBy73c5arVbS3t/fz6tPAOzt7a2kfgOBgHhdSVVEyITD4bxzYrEYe3R0RNoGg0E0d2BggJOfTCbl0P6cl6ykPAXIHWx1dfWndV5eXiT153K55FAWri0rKU8BGhoaSLzH4yF2u91O7ENDQ5/mer3eb+0aX+HHBYhGo6ID+GpwKysrxF9fXy+Hrih+/CRos9nI/dTUFM+fe1hyOp08fygUIvcGg0Fyv3V1dWhtbYXJZBIPlKMa8pgBubHpdJrn9/v9xM8wDM9vs9mIv7e3VxZHMfzoDFhdXSX3FouFs1f/C5PJBI1GA+D34eni4oLjLysrI/eBQOA/5yh4EBJN+udAAwDhcBjl5eWfxhUVFSGZTAIAlpeX0dbWhkQiwYnRarXY2trC5uYmAKCpqQk+n4/4Dw8P0dXVRdpS6eZyFM2RPKcEppfQEri8vJT9HPHx8SHY397eXt4cReOkDVm4uJAALS0tsgUYHR3l1LJYLHlvhVLjf2QJpNNpqFQq0na73UilUoJTkWEYPD8/Y2ZmhthyY6PRKHQ6HWmr1WrEYjEUFgo+zdNdAmNjY8RvNpsl19VqtSTP7XZzfGtra7yZMjg4yPr9fl4dj8dDdwnk+s/OziTXXV9fJ3k6nY7ndzqdspaU6Fgks8tNyikeDAY5PpfL9a2ja27uZ79uKBRia2trJQ++srJStD/hRSSCiYkJqFQqvL+/816ZJRIJTE5OIpvNcrYvqXC73bi6ukI2m8XDwwPvJKfX63F3d4dIJIKNjQ2cnJzg5uYGkUgEDMNAr9fDaDSis7MTw8PD5IwhBFl/gv8n/PFvhRUBaBOgDUUA2gRoQxGANgHaUASgTYA2FAFoE6ANRQDaBGhDEYA2AdpQBKBNgDYUAWgToA1FANoEaONve9o8PVvYS2AAAAAASUVORK5CYII=</Glyph>
	</Create>
	<role maxCount="1" minCount="1" name="Creator">
		<description xml:lang="en">
			<paragraph>
				<text>This is the role of the part that acts as the creator and owner of the token being created.</text>
			</paragraph>
		</description>
	</role>
	<role maxCount="1" minCount="1" name="TrustProvider">
		<description xml:lang="en">
			<paragraph>
				<text>This is the role of the trust provider that acts will host the token and approve its creation.</text>
			</paragraph>
		</description>
	</role>
	<parts>
		<templateOnly />
	</parts>
	<parameters>
		<stringParameter name="Title" value="" guide="Title" minLength="2">
			<description xml:lang="en">
				<paragraph>
					<text>Title of item.</text>
				</paragraph>
			</description>
		</stringParameter>
		<stringParameter name="Description" value="" guide="Description">
			<description xml:lang="en">
				<paragraph>
					<text>Description of item.</text>
				</paragraph>
			</description>
		</stringParameter>
		<numericalParameter name="Value" guide="Value of token" min="1" minIncluded="true">
			<description xml:lang="en">
				<paragraph>
					<text>The initial value of the token.</text>
				</paragraph>
			</description>
		</numericalParameter>
		<stringParameter name="Currency" value="SEK" guide="Currency" regEx="[A-Z]{3}" minLength="3" maxLength="3">
			<description xml:lang="en">
				<paragraph>
					<text>The initial currency of the token.</text>
				</paragraph>
			</description>
		</stringParameter>
		<stringParameter name="SendEdalerTo" value="">
			<description xml:lang="en">
				<paragraph>
					<text>Where to send edaler</text>
				</paragraph>
			</description>
		</stringParameter>
		<stringParameter name="SendEdalerFrom" value="">
			<description xml:lang="en">
				<paragraph>
					<text>Where to send edaler</text>
				</paragraph>
			</description>
		</stringParameter>
		<numericalParameter name="CommissionPercent" value="0" guide="Commision (%)" min="0" minIncluded="true" max="100" maxIncluded="true">
			<description xml:lang="en">
				<paragraph>
					<text>The commission the Trust Provider gets for creating the tokens.</text>
				</paragraph>
			</description>
		</numericalParameter>
		<calcParameter name="Commission" guide="Commission" exp="Value*CommissionPercent/100">
			<description xml:lang="en">
				<paragraph>
					<text>Commission to be paid to the Trust Provider</text>
				</paragraph>
			</description>
		</calcParameter>
		<dateParameter name="Expires" guide="Expiry date" exp="Expires&gt;Now.Date">
			<description xml:lang="en">
				<paragraph>
					<text>When token expires.</text>
				</paragraph>
			</description>
		</dateParameter>
	</parameters>
	<humanReadableText xml:lang="en">
		<section>
			<header>
				<text>Create Vaulter Item token</text>
			</header>
			<body>
				<paragraph>
					<text>This contract creates a Neuro-Feature™ token representing an item for sale on a remote site using the Vaulter™ app.</text>
				</paragraph>		
			</body>
		</section>
	</humanReadableText>
</contract>